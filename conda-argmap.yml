name: argmap

channels:
  - nvidia
  - pytorch
  - conda-forge
#  - defaults

dependencies:
  # base
  - python>=3.11
  # - pytorch::pytorch-cuda
  # Pytorch version >= 2.3.0 to support numpy>=2
  # see https://github.com/pytorch/pytorch/issues/107302
  - ipykernel
  - ipywidgets
  - python-dotenv
  - polars
  - protobuf

  # topic modeling
  - spacy
  # - spacy-model-en_core_web_lg # get this from huggingface instead to avoid spacy downgrade
  - sentence-transformers
  - hvplot
  - nbformat
  - datashader
  - scikit-image
  - plotly>=5.19.0 # newer version needed for certain plots in bertopic
  - umap-learn
  # - seaborn
  # - matplotlib

  # language model
  - transformers
  - accelerate

  - pip
  - pip:
    - torch
    - torchvision
    - joblib
    - bertopic
    - guidance
    - optimum # Later version than the one in the conda-forge channel
    # AutoGPTQ is not supported on macOS
    # - https://github.com/AutoGPTQ/AutoGPTQ
    # The below link generates error, replacing by specific version
    #Â - https://huggingface.co/spacy/en_core_web_lg/resolve/main/en_core_web_lg-any-py3-none-any.whl
    - https://github.com/explosion/spacy-models/releases/download/en_core_web_lg-3.8.0/en_core_web_lg-3.8.0-py3-none-any.whl
    # Latest version of transformers as of 2024-12-26 for modernBERT
    # Once version 4.28.x we can install from conda-forge or any repo, but not before then.
    # See https://huggingface.co/answerdotai/ModernBERT-base/discussions/3#6764f047eef1e726f2100ca3
    - git+https://github.com/huggingface/transformers
    - -e . # In stall local argmap package in editable mode

  # postgres support
  # - connectorx
  # - sqlalchemy
  # - psycopg2
